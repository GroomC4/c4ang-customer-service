# ====================================
# dev 환경 설정 (k3d 개발 환경)
# ====================================
# k3d 클러스터 내 PostgreSQL, Redis 등 인프라 사용
# 환경변수로 실제 연결 정보 주입

spring:
  datasource:
    master:
      url: jdbc:postgresql://customer-db:5432/customer_db
      username:
      password:
      driver-class-name: org.postgresql.Driver
    replica:
      url: jdbc:postgresql://customer-db:5432/customer_db
      username:
      password:
      driver-class-name: org.postgresql.Driver
      hikari:
        maximum-pool-size: 5

  data:
    redis:
      host: cache-redis
      port: 6379

# Platform Core DataSource 라우팅 설정
platform:
  datasource:
    replica-enabled: true
  jpa:
    hibernate:
      ddl-auto: none
      naming:
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
    properties:
      hibernate:
        format_sql: true  # SQL 포맷팅 활성화 (개발 환경)
        dialect: org.hibernate.dialect.PostgreSQLDialect
    show-sql: false  # logback으로 제어

# ====================================
# dev 환경 로그 레벨 (k3d 개발 환경)
# ====================================
logging:
  level:
    # ROOT 레벨 - INFO
    root: INFO

    # 프로젝트 패키지 - DEBUG 레벨 (개발 디버깅용)
    com.groom.customer: DEBUG

    # Spring Framework - INFO
    org.springframework: INFO
    org.springframework.web: DEBUG  # HTTP 요청/응답 디버깅

    # Hibernate/JPA - SQL 쿼리 디버깅
    org.hibernate: INFO
    org.hibernate.SQL: DEBUG  # SQL 쿼리 출력
    org.hibernate.orm.jdbc.bind: DEBUG  # SQL 파라미터 바인딩

  file:
    path: ./logs

security:
  jwt:
    key-id: ecommerce-key-1
    issuer: ecommerce-service-api
    audience: ecommerce-api  # Istio RequestAuthentication과 일치해야 함
    accessTokenExpirationMinutes: ${JWT_ACCESS_TOKEN_EXPIRATION_MINUTES:5}
    refreshTokenExpirationDays: 7
    # 개발/CI 환경용 RSA 키 (테스트 전용 - 운영 환경에서는 사용 금지)
    private-key: ${JWT_PRIVATE_KEY:-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCvD5SDEkoxLqiLgTeNbjLe2vpkgDEGtGh1lYPB/AALcEEC23v6EhMiTx41DDIw9X6oD+G/7GwbKpa9sxhvjYtGBUuMPmUhXwR9No13mRXeeiacbnsFRMUzp9iP9z0/vJTCGINcRrZA56B6buCbDq/d0H4YdE+Pz7+cMIsMGBrpg3YO2m1XDQaDWuxfXLv0WfVmvReAv+gyRT7KNzzvMdGeqD7eiMWYOkRqfvNY+Sox5EdlTB4/JTOWVO1JV8f2JcFWcb8vxH3i/+cZH11tOi7TWdM5Glz242nf3pEWKfjytzf1+/OgkXFOm9a8i8UigCS9jzeRo0xFYK32+KYvhfHRAgMBAAECggEAQ1cg79KHS6gBGbjZH8R2ORfPHf3Z3hRj4mdjSamgcsX5nBnF9Qoi5h29JvbMD90/nXKOin9tjn2xgsNz8OVn38WFrCsMR+v/FBN6E7mFmhEu7RnqpLoxiY9VVPvsSapHJuq7DTH+RbVUHASuzba2nALpnoqPWGi38mMR+dMD9zMBt8N0KEz4CvA8bfOKrh1xGskFPNRf2ScOJ2JmqkoBGyXrAobJGwp27Au7UNEdR496uRglbOrurr/eK9A1LvulVShgpxHX4FVPWJK3Zjdgc7tkqhBUpQh8uv0hlEL8Sv+1aluV5u958x9G86ioNAiblBoZnYRRcPB1Y37txwmWgQKBgQDZakjqZEFtuORxHFmK6LK2L9SdgCu/st85Ms0b35bI7MOMeYr2U5M4+e3hkxL3C9tFpZqtQIGYYU2l0OnCoLw1ctESZgGM/KiAaUydKvamszT1JtT2vtLGlpnYg7RjV7+sIaQUkH283n8BO+RovjqJG6XZbGrczgJ/01gHDM01CQKBgQDOIQhnT1BBHbqBDEyaiTmf7PCkBiCM2eiJfx5vfSXQcktRkze8XKRs1qKVJiQfR3TtmJa1fMwl3NbkkR9FawNYqSO2kAROr9Gli6wAPooPO5Vl2GES5V+5nI8G/iy1aPcYXq5Dz/yf1o+kbO/ytwERUXglTaMHnI4wNhCtDEQQiQKBgGKfzR3OhsOgKLiKtK/HqTHt9pPPzYizOoF24wYu4faZOIejpv7goJsq/Nbj4amBjmFEoyrOZTtbgF6kqzWntljEkcS30yJChqlhmuh80dCC4JYInHilzXVaYcWO0ShzaLZLuGO/u9oOUCyeH5nIGUOS8CP2A2/QX9/eXkMscnYJAoGAEqRMJUO4B1uP7XHWT7ePXZZJIRxovzRJ4n17nCueSt67TxJYXRGn0SwMIh8D70xAF+jP4HP75oS1bpBtWpLWB6OsVitqKE+gTy91i8QcKkqCNWa/SL0zzg6JpOFB29o1Vp/hdMKPn0kBTqaHgNTqJM3QZtdBokOXXGbXVT8hvLkCgYARs07jQ+hdwz4kz2P3X++CCkD3HEvJYbx5smrwvYu6DQgOvOdl4wFYKmmd35/S2u7Two8xKZysEZs9Ts6FxPLGH59lezuu8Uh/uKx34qGueJie9iXkwtcadD1H3lSpyck+hvzJkbNH4peDWhtthW+PeTiMG2mOPQRt+kY6QDPz8w==\n-----END PRIVATE KEY-----}
    public-key: ${JWT_PUBLIC_KEY:-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArw+UgxJKMS6oi4E3jW4y3tr6ZIAxBrRodZWDwfwAC3BBAtt7+hITIk8eNQwyMPV+qA/hv+xsGyqWvbMYb42LRgVLjD5lIV8EfTaNd5kV3nomnG57BUTFM6fYj/c9P7yUwhiDXEa2QOegem7gmw6v3dB+GHRPj8+/nDCLDBga6YN2DtptVw0Gg1rsX1y79Fn1Zr0XgL/oMkU+yjc87zHRnqg+3ojFmDpEan7zWPkqMeRHZUwePyUzllTtSVfH9iXBVnG/L8R94v/nGR9dbTou01nTORpc9uNp396RFin48rc39fvzoJFxTpvWvIvFIoAkvY83kaNMRWCt9vimL4Xx0QIDAQAB\n-----END PUBLIC KEY-----}

feign:
  clients:
    store-service:
      url: ${STORE_SERVICE_URL:http://store-api}
      connect-timeout: 5000
      read-timeout: 5000
      logger-level: full
  client:
    config:
      store-service:
        connectTimeout: 5000
        readTimeout: 5000
        loggerLevel: full
